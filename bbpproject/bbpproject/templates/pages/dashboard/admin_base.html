{% extends "base.html" %}

{% block navbar %}{% endblock %}
{% block footer %}{% endblock %}

{% block extra_head %}
<!-- Chart.js via Tailwind is mostly handled, but we need Chart.js library if not in base -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
    /* Custom Scrollbar for Sidebar */
    .sidebar::-webkit-scrollbar {
        width: 6px;
    }
    .sidebar::-webkit-scrollbar-thumb {
        background: #d4af37;
        border-radius: 3px;
    }
    
    .sidebar.mobile-hidden {
        transform: translateX(-100%);
    }

    @media (min-width: 1024px) {
        .sidebar.mobile-hidden {
            transform: translateX(0);
        }
    }
    
    /* Animations */
    .stat-card {
        transition: all 0.3s ease;
        animation: fadeInUp 0.5s ease-out;
    }
    .stat-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
    }
    
    @keyframes fadeInUp {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
    }
    
    .chart-container {
        animation: fadeIn 0.8s ease-out;
        position: relative;
    }
    
    /* Force chart height to prevent infinite growing */
    .chart-container canvas {
        width: 100% !important;
        height: 300px !important;
        max-height: 300px;
    }

    @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }
    
    /* Menu Items */
    .menu-item {
        transition: all 0.2s;
        border-left: 3px solid transparent;
    }
    .menu-item:hover {
        background: rgba(212, 175, 55, 0.1);
        border-left-color: #d4af37;
    }
    .menu-item.active {
        background: rgba(212, 175, 55, 0.15);
        border-left-color: #d4af37;
        color: #d4af37;
    }
    
    /* Status Badges */
    .status-badge {
        display: inline-flex;
        align-items: center;
        padding: 0.25rem 0.75rem;
        border-radius: 9999px;
        font-size: 0.75rem;
        font-weight: 600;
    }
    .status-pending { background: #fef3c7; color: #92400e; }
    .status-confirmed { background: #dbeafe; color: #1e40af; }
    .status-shipped { background: #e0e7ff; color: #3730a3; }
    .status-delivered { background: #d1fae5; color: #065f46; }
    .status-cancelled { background: #fee2e2; color: #991b1b; }
    
    .table-row { transition: all 0.2s; }
    .table-row:hover { background: #f9fafb; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05); }
    
    .notification-dot {
        width: 8px;
        height: 8px;
        background: #ef4444;
        border-radius: 50%;
        position: absolute;
        top: 8px;
        right: 8px;
        animation: pulse 2s infinite;
    }
    @keyframes pulse {
        0%, 100% { opacity: 1; }
        50% { opacity: 0.5; }
    }
</style>
{% endblock %}

{% block content %}
<div class="flex min-h-screen bg-gray-50 font-sans">
    <!-- Sidebar -->
    {% include "pages/dashboard/include/sidebar.html" %}

    <!-- Main Content -->
    <main class="flex-1 lg:ml-[280px] transition-all duration-300">
        <!-- Top Bar -->
        {% include "pages/dashboard/include/topbar.html" %}

        <!-- Dashboard Content -->
        <div class="p-6">
            {% block dashboard_content %}
            {% endblock %}
        </div>
    </main>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // Sidebar Toggle
    const sidebar = document.getElementById('sidebar');
    const sidebarToggle = document.getElementById('sidebarToggle');
    
    if (sidebarToggle) {
        sidebarToggle.addEventListener('click', () => {
            sidebar.classList.toggle('mobile-hidden');
            // Overlay logic if needed for mobile
        });
    }

    // Chart.js init if charts exist
    const salesChartCanvas = document.getElementById('salesChart');
    if (salesChartCanvas) {
        const salesCtx = salesChartCanvas.getContext('2d');
        new Chart(salesCtx, {
            type: 'line',
            data: {
                labels: ['Août', 'Sept', 'Oct', 'Nov', 'Déc', 'Jan'],
                datasets: [{
                    label: 'Ventes (FCFA)',
                    data: [1850000, 2100000, 1950000, 2300000, 2200000, 2450000],
                    borderColor: '#d4af37',
                    backgroundColor: 'rgba(212, 175, 55, 0.1)',
                    tension: 0.4,
                    fill: true,
                    pointBackgroundColor: '#d4af37',
                    pointBorderColor: '#fff',
                    pointBorderWidth: 2,
                    pointRadius: 5,
                    pointHoverRadius: 7
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { legend: { display: false } },
                scales: {
                    y: {
                        beginAtZero: true,
                        ticks: { callback: function(value) { return value.toLocaleString() + ' FCFA'; } }
                    }
                }
            }
        });
    }

    const categoryChartCanvas = document.getElementById('categoryChart');
    if (categoryChartCanvas) {
        const categoryCtx = categoryChartCanvas.getContext('2d');
        new Chart(categoryCtx, {
            type: 'doughnut',
            data: {
                labels: ['Lisses', 'Ondulées', 'Bouclées', 'Premium'],
                datasets: [{
                    data: [40, 30, 20, 10],
                    backgroundColor: ['#d4af37', '#000000', '#6b7280', '#f4e5c3'],
                    borderWidth: 0
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'bottom',
                        labels: { padding: 20, usePointStyle: true }
                    }
                }
            }
        });
    }

    // Menu Active State
    document.querySelectorAll('.menu-item').forEach(item => {
        item.addEventListener('click', function(e) {
            // e.preventDefault(); // Allow navigation if real links
            document.querySelectorAll('.menu-item').forEach(el => el.classList.remove('active'));
            this.classList.add('active');
        });
    });
</script>
{% endblock %}